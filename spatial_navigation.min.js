(function(){function G(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&void 0!==arguments[b][c]&&(a[c]=arguments[b][c]);return a}function z(a){return"string"===typeof a?[].slice.call(document.querySelectorAll(a)):"object"===typeof a&&a.length?[].slice.call(a):"object"===typeof a&&1===a.nodeType?[a]:[]}function H(a,b){return"string"===typeof b?Z.call(a,b):"object"===typeof b&&b.length?0<=b.indexOf(a):"object"===typeof b&&1===b.nodeType?
a===b:!1}function D(a){var b=[],c=function(e){e&&0>b.indexOf(e)&&g[e]&&!g[e].disabled&&b.push(e)};a?c(a):(c(E),c(u),Object.keys(g).map(c));for(a=0;a<b.length;a++){c=b[a];var d=aa(c)||P(c)||I(c).filter(function(e){return"-2"!=e.getAttribute("tabindex")})[0];if(d)return A(d,c)}return!1}function aa(a){var b=g[a].defaultElement;if(!b)return null;"string"===typeof b&&(b=z(b)[0]);return x(b,a,!0)?b:null}function P(a){var b=g[a].lastFocusedElement;return x(b,a,!0)?b:null}function x(a,b,c){if(!a||!b||!g[b]||
g[b].disabled||0>=a.offsetWidth&&0>=a.offsetHeight||a.hasAttribute("disabled")||c&&!H(a,g[b].selector))return!1;if("function"===typeof g[b].navigableFilter){if(!1===g[b].navigableFilter(a,b))return!1}else if("function"===typeof y.navigableFilter&&!1===y.navigableFilter(a,b))return!1;return!0}function I(a){return z(g[a].selector).filter(function(b){return x(b,a)})}function A(a,b,c){if(!a)return!1;var d=r(),e=function(){d&&d.blur();a.focus();F(a,b)};if(l)return!e();l=!0;if(t)return e(),!(l=!1);if(d){e=
{nextElement:a,nextSectionId:b,direction:c,"native":!1};if(!m(d,"willunfocus",e))return l=!1;d.blur();m(d,"unfocused",e,!1)}c={previousElement:d,sectionId:b,direction:c,"native":!1};if(!m(a,"willfocus",c))return l=!1;a.focus();m(a,"focused",c,!1);l=!1;return!F(a,b)}function r(){if(document.activeElement&&document.activeElement!==document.body)return document.activeElement}function m(a,b,c,d){var e=document.createEvent("CustomEvent");if("contextmenu"==b){e.initCustomEvent(b,!0,4>arguments.length?!0:
d,c);var f=a.getBoundingClientRect();Object.defineProperties(e,{layerX:{value:a.clientLeft+25,enumerable:!0},layerY:{value:a.clientTop,enumerable:!0},clientX:{value:f.x,enumerable:!0},clientY:{value:f.y+f.height,enumerable:!0},pageX:{value:f.x,enumerable:!0},pageY:{value:f.y,enumerable:!0}})}else e.initCustomEvent("sn:"+b,!0,4>arguments.length?!0:d,c);return a.dispatchEvent(e)}function F(a,b){b||(b=n(a));b&&(g[b].lastFocusedElement=a,u=b)}function n(a){for(var b in g)if(!g[b].disabled&&H(a,g[b].selector))return b}
function J(a,b){if("@"==a.charAt(0))return D(1==a.length?null:a.substr(1));var c=z(a)[0];if(c){var d=n(c);if(x(c,d))return A(c,d,b)}return!1}function Q(a,b,c){var d=b.getAttribute("data-sn-"+a);if("string"===typeof d)return""!==d&&J(d,a)?!0:!!K(b,a);d={};var e=[];for(f in g)e=e.concat(d[f]=I(f));var f=G({},y,g[c]);if("self-only"==f.restrict||"self-first"==f.restrict){var k=d[c];(d=L(b,a,M(k,b),f))||"self-first"!=f.restrict||(d=L(b,a,M(e,k),f))}else d=L(b,a,M(e,b),f);if(d){e=n(d);if(c!=e){if(c=R(c,
a))return!0;if(null===c)return!!K(b,a)}return d.closest("aside")||(b=N(d),window.pageYOffset+b.bottom>window.pageYOffset&&window.pageYOffset+b.top<window.pageYOffset+document.documentElement.clientHeight+100&&window.pageXOffset+b.right>window.pageXOffset&&window.pageXOffset+b.left<window.pageXOffset+document.documentElement.clientWidth)?A(d,e,a):!1}return R(c,a)?!0:!!K(b,a)}function L(a,b,c,d){if(!(a&&b&&c&&c.length))return null;d=[];for(var e=0;e<c.length;e++){var f=N(c[e]);f&&d.push(f)}if(!d.length)return null;
var k=N(a);if(!k)return null;a=function(h){h=h.center.x<k.center.x?k.center.x-h.right:h.left-k.center.x;return 0>h?0:h};c=function(h){h=h.center.y<k.center.y?k.center.y-h.bottom:h.top-k.center.y;return 0>h?0:h};e=function(h){h=h.center.x<k.center.x?k.left-h.right:h.left-k.left;return 0>h?0:h};f=function(h){h=h.center.y<k.center.y?k.top-h.bottom:h.top-k.top;return 0>h?0:h};var B=function(h){return h.top},ba=function(h){return-1*h.bottom},C=function(h){return h.left},ca=function(h){return-1*h.right};
d=S(d,k);var p=S(d[4],k.center);switch(b){case "left":d=[{group:p[0].concat(p[3]).concat(p[6]),distance:[a,B]},{group:d[3],distance:[a,B]},{group:d[0].concat(d[6]),distance:[c,ca,f]}];break;case "right":d=[{group:p[2].concat(p[5]).concat(p[8]),distance:[a,B]},{group:d[5],distance:[a,B]},{group:d[2].concat(d[8]),distance:[c,C,f]}];break;case "up":d=[{group:p[0].concat(p[1]).concat(p[2]),distance:[c,C]},{group:d[1],distance:[c,C]},{group:d[0].concat(d[2]),distance:[a,ba,e]}];break;case "down":d=[{group:p[6].concat(p[7]).concat(p[8]),
distance:[c,C]},{group:d[7].concat(d[7].length&&d[8].length&&d[7][0].top>d[8][0].top?d[8]:[]),distance:[c,C]},{group:d[6].concat(d[8]),distance:[a,B,e]}];break;default:return null}a=T(d.slice(0,-1));return!a&&(!(a=T(d.slice(-1)))||"up"==b&&(k.top<a[0].top||k.left<a[0].left)||"right"==b&&(k.left>a[0].left||k.bottom>a[0].bottom||a[0].right>document.documentElement.clientWidth)||"down"==b&&(k.bottom>a[0].bottom||k.right<a[0].right||0>a[0].left)||"left"==b&&(k.left<a[0].left||k.top<a[0].top||0>a[0].left))?
null:a[0].element}function M(a,b){Array.isArray(b)||(b=[b]);for(var c=0,d;c<b.length;c++)0<=(d=a.indexOf(b[c]))&&a.splice(d,1);return a}function N(a){var b=a.getBoundingClientRect();b={left:b.left,top:b.top,right:b.right,bottom:b.bottom,width:b.width,height:b.height};b.element=a;b.center={x:b.left+Math.floor(b.width/2),y:b.top+Math.floor(b.height/2)};b.center.left=b.center.right=b.center.x;b.center.top=b.center.bottom=b.center.y;return b}function S(a,b){for(var c=[[],[],[],[],[],[],[],[],[]],d=0;d<
a.length;d++){var e=a[d],f=e.center;f=3*(f.y<b.top?0:f.y<=b.bottom?1:2)+(f.x<b.left?0:f.x<=b.right?1:2);c[f].push(e);-1!==[0,2,6,8].indexOf(f)&&(e.left<=b.right-.5*b.width&&(2===f?c[1].push(e):8===f&&c[7].push(e)),e.right>=b.left+.5*b.width&&(0===f?c[1].push(e):6===f&&c[7].push(e)),e.top<=b.bottom-.5*b.height&&(6===f?c[3].push(e):8===f&&c[5].push(e)),e.bottom>=b.top+.5*b.height&&(0===f?c[3].push(e):2===f&&c[5].push(e)))}return c}function T(a){for(var b=null,c=0;c<a.length;c++)a[c].group.length&&(b=
a[c]);if(!b)return null;b.group.sort(function(d,e){for(var f=0;f<b.distance.length;f++){var k=b.distance[f];if(k=k(d)-k(e))return k}return 0});return b.group}function R(a,b){if(g[a].leaveFor&&void 0!==g[a].leaveFor[b]){var c=g[a].leaveFor[b];if("string"===typeof c)return""===c?null:J(c,b);var d=n(c);if(x(c,d))return A(c,d,b)}return!1}function K(a,b){m(a,"navigatefailed",{direction:b},!1)}function U(a){if(!(!v||t||a.altKey||a.ctrlKey||a.metaKey||a.shiftKey)){var b,c=function(){a.preventDefault();a.stopPropagation();
return!1},d={37:"left",38:"up",39:"right",40:"down"}[a.keyCode];if(d){if(!(b=r())&&(u&&(b=P(u)),!b))return D(),c();var e=n(b);if(e){if(!(b.scrollHeight==b.offsetHeight||-1!=["hidden","visible"].indexOf(getComputedStyle(b).overflow)||("up"!=d||0>=b.scrollTop)&&("down"!=d||b.scrollTop>=b.scrollHeight-b.offsetHeight)))return!1;if(m(b,"willmove",{direction:d,sectionId:e,cause:"keydown"})&&(Q(d,b,e)||b.closest("aside")))return c()}}else if(13==a.keyCode&&(b=r())&&n(b))return null==w?w=a.timeStamp:w&&1500<
a.timeStamp-w&&(m(b,"contextmenu"),w=0),m(b,"enter-down"),c()}}function V(a){if(!(a.altKey||a.ctrlKey||a.metaKey||a.shiftKey||t)&&v&&13==a.keyCode){var b=r();b&&n(b)&&(0!=w&&b.click(),m(b,"enter-up"),a.preventDefault(),a.stopPropagation());w=null}}function W(a){if(a.target!==window&&a.target!==document&&v&&!l){var b=n(a.target);if(b){if(t)return F(a.target,b);var c={sectionId:b,"native":!0};m(a.target,"willfocus",c)?(m(a.target,"focused",c,!1),F(a.target,b)):(l=!0,a.target.blur(),l=!1)}else a.relatedTarget&&
(l=!0,a.relatedTarget.focus(),l=!1)}}function X(a){if(a.target!==window&&a.target!==document&&!t&&v&&!l&&n(a.target)){var b={"native":!0};m(a.target,"willunfocus",b)?m(a.target,"unfocused",b,!1):(l=!0,setTimeout(function(){a.target.focus();l=!1}))}}var y={selector:"",disabled:!1,defaultElement:"",leaveFor:null,restrict:"self-first",tabIndexIgnoreList:"input, select, textarea, iframe, [contentEditable=true]",navigableFilter:null},Y=0,O=!1,t=!1,w=null,g={},v=0,E="",u="",l=!1,Z=Element.prototype.matches||
Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||function(a){return 0<=[].slice.call((this.parentNode||this.document).querySelectorAll(a)).indexOf(this)},q={init:function(a){var b=[];if(!O&&(window.addEventListener("keydown",U),window.addEventListener("keyup",V),window.addEventListener("focus",W,!0),window.addEventListener("blur",X,!0),O=!0,a)){for(var c in a)b.push(q.add(c,
a[c]));q.makeFocusable();q.focus()}return b},uninit:function(){window.removeEventListener("blur",X,!0);window.removeEventListener("focus",W,!0);window.removeEventListener("keyup",V);window.removeEventListener("keydown",U);q.clear();Y=0;O=!1},clear:function(){g={};v=0;u=E="";l=!1},add:function(a,b){var c={};if("object"===typeof a)c=a;else if("string"===typeof a&&"object"===typeof b){var d=a;c=b}if(!d)if("string"===typeof c.id)d=c.id;else for(;g[d="section-"+String(++Y)];);if(g[d])throw Error('Section "'+
d+'" has already existed!');g[d]={};v++;q.set(d,c);return d},set:function(a,b){if("object"===typeof a)var c=a;else if("string"===typeof a&&"object"===typeof b){var d=a;c=b;if(!g[d])throw Error('Section "'+d+"\" doesn't exist!");}else return;for(var e in c)void 0!==y[e]&&(d?g[d][e]=c[e]:void 0!==c[e]&&(y[e]=c[e]));d&&(g[d]=G({},g[d]))},remove:function(a){if(!a||"string"!==typeof a)throw Error('Please assign the "sectionId"!');return g[a]?(g[a]=void 0,g=G({},g),v--,u===a&&(u=""),!0):!1},disable:function(a){return g[a]?
g[a].disabled=!0:!1},enable:function(a){return g[a]?!(g[a].disabled=!1):!1},pause:function(){t=!0},resume:function(){t=!1},move:function(a,b){a=a.toLowerCase();var c=b?z(b)[0]:r();if(!c)return!1;var d=n(c);return d&&m(c,"willmove",{direction:a,sectionId:d,cause:"api"})?Q(a,c,d):!1},makeFocusable:function(a){var b=function(d){var e=void 0!==d.tabIndexIgnoreList?d.tabIndexIgnoreList:y.tabIndexIgnoreList;z(d.selector).forEach(function(f){H(f,e)||f.getAttribute("tabindex")||f.setAttribute("tabindex",
"-1")})};if(a)if(g[a])b(g[a]);else throw Error('Section "'+a+"\" doesn't exist!");else for(var c in g)b(g[c])},focus:function(a,b){var c=!1;void 0===b&&"boolean"===typeof a&&(b=a,a=void 0);var d=!t&&b;d&&q.pause();if(a)if("string"===typeof a)c=g[a]?D(a):J(a);else{var e=n(a);x(a,e)&&(c=A(a,e))}else c=D();d&&q.resume();return c},setDefaultSection:function(a){if(a)if(g[a])E=a;else throw Error('Section "'+a+"\" doesn't exist!");else E=""},getElement:function(){return r()},getSection:function(a){return n(a||
r())},getElements:function(a){return I(a||n(r()))},getSections:function(){return g}};"SpatialNavigation"in window||(window.SpatialNavigation=q);"object"===typeof module&&(module.exports=q)})();